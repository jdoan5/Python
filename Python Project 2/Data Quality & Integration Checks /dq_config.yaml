flowchart TD
  CFG[dq_config.yaml]

  subgraph SOURCE["source"]
    S_TYPE["type: csv"]
    S_PATH["path: data/customers.csv"]
  end

  subgraph CHECKS["checks"]
    subgraph TBL["table"]
      MIN["min_rows: 3"]
      UK["unique_keys: [customer_id]"]
      NDR["no_duplicate_rows: true"]
    end
    subgraph COLS["columns"]
      C_ID["customer_id\n— dtype: int\n— nullable: false\n— unique: true"]
      C_EMAIL["email\n— dtype: str\n— nullable: false\n— regex: ^[^@\\s]+@[^@\\s]+\\.[^@\\s]+$"]
      C_SIGN["signup_date\n— dtype: date\n— nullable: false\n— min: 2020-01-01"]
      C_PLAN["plan\n— dtype: str\n— nullable: false\n— allowed: free | basic | pro"]
    end
  end

  subgraph INTEG["integrations"]
    FK1["foreign_keys[0]"]
    CHILD["child.column: plan"]
    PARENT["parent: csv\npath: data/plan_lookup.csv\ncolumn: plan_code"]
    FK1 --> CHILD
    FK1 --> PARENT
  end

  CFG --> SOURCE
  CFG --> CHECKS
  CFG --> INTEG